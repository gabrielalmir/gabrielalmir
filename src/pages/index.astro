---
import Layout from "@/layouts/Layout.astro";
import { HomeClient } from "@/components/home-client";
import { getLatestPostPreviews } from "@/lib/blog";

const latestPosts = getLatestPostPreviews(3);

let githubProjects: any[] = [];
try {
  const res = await fetch(
    "https://api.github.com/users/gabrielalmir/repos?sort=stars&per_page=20&direction=desc"
  );
  if (res.ok) {
    githubProjects = await res.json();
  }
} catch (e) {
  console.warn("Failed to fetch GitHub projects at build time:", e);
}
---

<Layout
  title="Gabriel Almir | Desenvolvedor Backend Node.js"
  preloadImage="/me.webp"
>
  <HomeClient
    client:visible
    latestPosts={latestPosts}
    githubProjects={githubProjects}
  />
</Layout>
